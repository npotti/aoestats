define(["require","exports","../utils/commonutils","ojs/ojarraydataprovider","knockout","ojs/ojtable","ojs/ojchart","ojs/ojselectsingle"],(function(require,e,a,t,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.selectedTeam=l.observable(),this.fplBaseUrl="https://fantasy.premierleague.com/api/",this.aoeTeams=[],this.curr_gw=1,this.playerPicksMap=new Map,this.aoeTeamFplTeamMap=new Map,this.fplTeamAoeAvgMap=new Map,this.gainTableList=l.observableArray([]),this.gainDataProvider=l.observable(),this.showTable=l.observable(!1),this.valueChangedHandler=e=>{this.gainTableList.removeAll(),console.log(e.detail.value),this.fetchTableData(e.detail.value)},console.log("team "+a.default.team());a.default.fetchFPLPlayers().then(e=>{this.curr_gw=a.default.curr_gw;a.default.fetchAoeTeams().then(e=>{this.aoeTeams=e,this.aoeTeams.forEach(e=>{const t=[];e.players.forEach(e=>{const a=this.fetchPicks(e.fpl_id);t.push(a)}),Promise.all(t).then(t=>{e.players.forEach(t=>{this.playerPicksMap.get(t.fpl_id).forEach(t=>{let l=a.default.fplPlayerMap.get(t.element).event_points,s=a.default.fplTeamsMap.get(a.default.fplPlayerMap.get(t.element).team).name;if(this.aoeTeamFplTeamMap.get(e.id))if(this.aoeTeamFplTeamMap.get(e.id).get(s)){let a=this.aoeTeamFplTeamMap.get(e.id).get(s).valueOf()+l*t.multiplier;this.aoeTeamFplTeamMap.get(e.id).set(s,a)}else{let a=l*t.multiplier;this.aoeTeamFplTeamMap.get(e.id).set(s,a)}else{console.log("Inside else");let a=new Map,i=l*t.multiplier;a.set(s,i),this.aoeTeamFplTeamMap.set(e.id,a)}})});for(let e of Array.from(a.default.fplTeamsMap.entries())){let a=e[1].name,t=0;for(let e of Array.from(this.aoeTeamFplTeamMap.entries())){let l=e[1];l.has(a)&&(t+=l.get(a).valueOf())}this.fplTeamAoeAvgMap.set(a,t/10)}console.log("Execution completed")})})})});this.teamsLovDataProvider=new t([{value:1,label:"Peaky Blinders"},{value:2,label:"Reservoir Dogs"},{value:3,label:"Brooklyn 6-6"},{value:4,label:"Dunder Mifflin"},{value:5,label:"Sons of Anarchy"},{value:6,label:"Watchmen"},{value:7,label:"The Boys"},{value:8,label:"True Detectives"},{value:9,label:"F.R.I.E.N.D.S"},{value:10,label:"Vikings"}],{keyAttributes:"value"}),console.log(a.default.team()),setTimeout(()=>{this.fetchTableData(a.default.fetchTeamId(a.default.team()))},2e3)}fetchTableData(e){let l=this.aoeTeamFplTeamMap.get(e);if(l){console.log("inside");for(let e of Array.from(a.default.fplTeamsMap.entries())){let t=e[1].name,s=l.has(t)?l.get(t):0,i=this.fplTeamAoeAvgMap.has(t)?this.fplTeamAoeAvgMap.get(t):0,o={team:t,count:s,avg:a.default.roundToTwo(i),gain:a.default.roundToTwo(s.valueOf()-i.valueOf())};this.gainTableList.push(o)}this.gainDataProvider(new t(this.gainTableList)),this.showTable(!0)}else this.showTable(!1)}connected(){}disconnected(){}transitionCompleted(){}fetchPicks(e){return new Promise(a=>{let t="https://fantasy.premierleague.com/api/entry/"+e+"/event/"+this.curr_gw+"/picks/";fetch(t).then(e=>e.json()).then(t=>{const l=t;this.playerPicksMap.set(e,l.picks),a(!0)})})}}}));